(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(t,e,i){"use strict";function n(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=document.createEvent("Event");for(var r in n.initEvent(e,!0,!0),i)n[r]=i[r];return t.dispatchEvent(n)}function r(t,e){for(var i in e){var n=!0,r=!1,o=void 0;try{for(var s,a=i.split(/\s+/)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;t.removeEventListener(l,e[i])}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}function o(t,e){for(var i in e){var n=!0,r=!1,o=void 0;try{for(var s,a=i.split(/\s+/)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;t.addEventListener(l,e[i])}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement(t);for(var n in e)n in i?i[n]=e[n]:i.setAttribute(n,e[n]);return i}function a(t,e){if(t.closest)return t.closest(e);for(var i=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t&&!i.call(t,e);)t=t.parentElement;return t}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return Array.prototype.slice.call(e.querySelectorAll(t))}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return e.querySelector(t)}function u(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"data-";for(var o in e)if(t[o]=e[o],i.hasOwnProperty(o)&&(t[o]=i[o]),n){var s=r+o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();n.hasAttribute(s)&&("number"==typeof e[o]?t[o]=parseInt(n.getAttribute(s),10):!1===e[o]?t[o]=!0:t[o]=n.getAttribute(s))}}function h(t){return t.replace(/[\^\$\\\.\*\+\?\(\)\[\]\{\}\|]/g,"\\$&")}function d(t){try{document.querySelector(t)}catch(t){return!1}return!0}i.r(e),i.d(e,"dispatch",(function(){return n})),i.d(e,"ignore",(function(){return r})),i.d(e,"listen",(function(){return o})),i.d(e,"create",(function(){return s})),i.d(e,"closest",(function(){return a})),i.d(e,"many",(function(){return l})),i.d(e,"one",(function(){return c})),i.d(e,"config",(function(){return u})),i.d(e,"escapeRegExp",(function(){return h})),i.d(e,"cssSelectorSupported",(function(){return d}))},1:function(t,e,i){"use strict";function n(t,e){return[[e[0][0]-t[0][0],e[0][1]-t[0][1]],[e[1][0]-t[1][0],e[1][1]-t[1][1]]]}function r(t){return Math.abs(t[1][1]-t[0][1])}function o(t){return Math.abs(t[1][0]-t[0][0])}function s(t,e){return[[t[0][0]*e,t[0][1]*e],[t[1][0]*e,t[1][1]*e]]}function a(t,e){if(90===e||270===e){var i=o(t),n=r(t),s=[t[0][0]+i/2,t[0][1]+n/2];return[[s[0]-n/2,s[1]-i/2],[s[0]+n/2,s[1]+i/2]]}return[t[0].slice(),t[1].slice()]}i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return s})),i.d(e,"e",(function(){return a}))},11:function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"ErrorMessage",(function(){return h}));var r={};i.r(r),i.d(r,"Metadata",(function(){return P}));var o={};i.r(o),i.d(o,"FileField",(function(){return q}));var s={};i.r(s),i.d(s,"GalleryItem",(function(){return X}));var a={};i.r(a),i.d(a,"Gallery",(function(){return $}));var l=i(9),c=i(0);function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h=function(){function t(e){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._dom={clear:null,container:null,error:null,message:null},this._dom.container=e,this._handlers={clear:function(t){t.preventDefault(),0===t.buttons&&c.dispatch(i.error,"clear")}}}var e,i,n;return e=t,(i=[{key:"destroy",value:function(){null!==this.error&&this.error.parentNode.removeChild(this.error),this._dom.clear=null,this._dom.error=null,this._dom.message=null}},{key:"init",value:function(t){var e=this.constructor;this._dom.error=c.create("div",{class:e.css.error,title:t}),this._dom.clear=c.create("div",{class:e.css.clear}),this._dom.error.appendChild(this._dom.clear),this._dom.message=c.create("div",{class:e.css.message}),this._dom.message.textContent=t,this._dom.error.appendChild(this._dom.message),this._dom.container.appendChild(this.error),c.listen(this._dom.clear,{click:this._handlers.clear})}},{key:"error",get:function(){return this._dom.error}}])&&u(e.prototype,i),n&&u(e,n),t}();h.css={clear:"mh-file-error__clear",error:"mh-file-error",message:"mh-file-error__message"};var d=i(14),p=i(12),f=i(26),m=i(17);function _(t,e){return function(i){return new p.Acceptor(i[t],"".concat(i.input.name,"__acceptor"),i._options.label,i._options.dropLabel,i._options.allowDrop,i._options.accept,e)}}function v(){return function(t,e){var i=new FormData;return i.append("file",e),i}}function g(t){return function(e){var i=e[t];return new d.ImageEditor(e.getAssetProp("editingURL"),i.cropAspectRatio,i.fixCropAspectRatio,i.maxPreviewSize)}}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;function i(i,n,r){var o=null;return e&&(o=i[e]),new f.Uploader(i[t],n,r,"horizontal",f.defaultStatusTemplate,o)}return i}function b(t,e){return function(i){switch(i[e].fileType){case"file":return new m.FileViewer(i[t],i.getAssetProp("filename"),i.getAssetProp("fileLength"));case"image":return new m.ImageViewer(i[t],i.getAssetProp("previewURL"));case"svg_image":return new m.ImageViewer(i[t],i.getAssetProp("url"),{download:!0,metadata:!0,remove:!0})}return null}}var w=i(30);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function C(t,e,i){return(C=x()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&E(r,i.prototype),r}).apply(null,arguments)}function O(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function S(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t,e,i){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function R(t,e,i){return e&&A(t.prototype,e),i&&A(t,i),t}var z=function(){function t(e,i,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];L(this,t),this._label=i,this._key=n,this._initialValue=r,this._readOnly=o,this._dom={container:null,label:null,input:null,prop:null},this._dom.container=e}return R(t,[{key:"destroy",value:function(){null!==this.prop&&(this._dom.container.removeChild(this.prop),this._dom.prop=null)}},{key:"init",value:function(){var t=this.constructor;this._dom.prop=c.create("div",{class:t.css.prop}),this._dom.label=c.create("div",{class:t.css.label}),this._dom.label.textContent=this._label,this.prop.appendChild(this._dom.label),this._dom.value=c.create("input",{class:t.css.value}),this._dom.value.value=this._initialValue,this._readOnly&&(this.prop.classList.add(t.css.readOnly),this._dom.value.readOnly=!0),this.prop.appendChild(this._dom.value),this._dom.container.appendChild(this.prop)}},{key:"key",get:function(){return this._key}},{key:"value",get:function(){return this._dom.value.value}},{key:"prop",get:function(){return this._dom.prop}},{key:"readOnly",get:function(){return this._readOnly}}]),t}();z.css={label:"mh-meta-prop__label",prop:"mh-meta-prop",readOnly:"mh-meta-prop--read-only",value:"mh-meta-prop__value"};var P=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return L(this,e),(i=S(this,T(e).call(this,n)))._props=t,i._propComponents=[],i._dom.props=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(e,t),R(e,[{key:"destroy",value:function(){null!==this.props&&(this.content.removeChild(this._dom.props),this._dom.props=null),j(T(e.prototype),"destroy",this).call(this)}},{key:"init",value:function(){var t=this.constructor;j(T(e.prototype),"init",this).call(this,t.css.metadata),this._dom.props=c.create("div",{class:t.css.props}),this._propComponents=[];var i=!0,n=!1,r=void 0;try{for(var o,s=this._props[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value,l=C(z,[this._dom.props].concat(O(a)));this._propComponents.push(l),l.init()}}catch(t){n=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}this.content.appendChild(this._dom.props),this.addButton("okay","okay"),this.addButton("cancel","cancel")}},{key:"props",get:function(){var t={},e=!0,i=!1,n=void 0;try{for(var r,o=this._propComponents[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;s.readOnly||(t[s.key]=s.value)}}catch(t){i=!0,n=t}finally{try{e||null==o.return||o.return()}finally{if(i)throw n}}return t}}]),e}(w.Overlay);function I(){return function(t,e){var i=JSON.parse(e).payload;if(i.asset)return i.asset;if(i.reason)throw new l.ResponseError(i.reason);throw new l.ResponseError("Unable to accept this file")}}function D(t,e){return function(i,n,r,o){var s=i[t],a=i[e],l=[];switch(r){case"alt":return"set"===n?(s.user_meta.alt=o,o):s.user_meta.alt||"";case"contentType":return s.content_type;case"downloadURL":return s.url;case"editingURL":return s.variations[a.editing].url;case"filename":return s.filename;case"fileLength":return function(t){if(0===t)return"0 bytes";var e=Math.floor(Math.log(t)/Math.log(1024)),i=parseFloat((t/Math.pow(1024,e)).toFixed(1));return"".concat(i," ").concat(["bytes","kb","mb","gb","tb","pb"][e])}(s.core_meta.length);case"imageMode":return s.core_meta.image.mode;case"imageSize":return s.core_meta.image.size.join(" x ");case"previewURL":return"set"===n?(s.preview_uri=o,o):s.preview_uri?s.preview_uri:s.variations[a.preview].url;case"transforms":if("set"===n){var c=!0,u=!1,h=void 0;try{for(var d,p=o[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var f=d.value;switch(f[0]){case"rotate":l.push({id:"image.rotate",settings:{angle:f[1]}});break;case"crop":l.push({id:"image.crop",settings:{top:f[1][0][1],left:f[1][0][0],bottom:f[1][1][1],right:f[1][1][0]}})}}}catch(t){u=!0,h=t}finally{try{c||null==p.return||p.return()}finally{if(u)throw h}}return s.base_transforms=l,o}var m=!0,_=!1,v=void 0;try{for(var g,y=s.base_transforms[Symbol.iterator]();!(m=(g=y.next()).done);m=!0){var b=g.value;switch(b.id){case"image.rotate":l.push(["rotate",b.settings.angle]);break;case"image.crop":l.push(["crop",[[b.settings.left,b.settings.top],[b.settings.right,b.settings.bottom]]])}}}catch(t){_=!0,v=t}finally{try{m||null==y.return||y.return()}finally{if(_)throw v}}return l;case"url":return s.url}return""}}function M(t){return function(e){var i=e[t],n=function(t){return e.getAssetProp(t)},r=[["Filename","filename",n("filename"),!0],["Content type","contentType",n("contentType"),!0],["File size","fileLength",n("fileLength"),!0]];return"image"===i.fileType?(r.push(["Mode","imageMode",n("imageMode"),!0]),r.push(["Size","imageSize",n("imageSize"),!0]),r.push(["Alt","alt",n("alt"),!1])):"svg_image"===i.fileType&&r.push(["Alt","alt",n("alt"),!1]),new P(r)}}function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}P.css={metadata:"mh-metadata",props:"mh-metadata__props"};var q=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-mh-file-field--";if(N(this,t),this._options={},c.config(this._options,{accept:"",allowDrop:!1,cropAspectRatio:"1.0",dropLabel:"Drop file here",editing:"editing",fileType:"file",fixCropAspectRatio:!1,label:"Select a file...",preview:"preview",maxPreviewSize:[480,480],uploadUrl:"/upload"},i,e,n),this._options.cropAspectRatio=parseFloat(this._options.cropAspectRatio),"string"==typeof this._options.maxPreviewSize){var r=this._options.maxPreviewSize.split(",");this._options.maxPreviewSize=[r[0],r[1]]}this._behaviours={},c.config(this._behaviours,{acceptor:"default",asset:"manhattan",assetProp:"manhattan",formData:"default",imageEditor:"default",metadata:"manhattan",uploader:"default",viewer:"default"},i,e,n),this._asset=null,this._state="initializing",this._acceptor=null,this._uploader=null,this._viewer=null,this._error=null,this._dom={input:null,field:null},this._dom.input=e}var e,i,n;return e=t,(i=[{key:"clearError",value:function(){this._error&&(this._error.destroy(),this.field.classList.remove(this.constructor.css.hasError))}},{key:"clear",value:function(){var t=this,e=this.constructor;this._destroyStateComponent(),this._asset=null,this.input.value="";var i=this._behaviours.acceptor;this._acceptor=e.behaviours.acceptor[i](this),this._acceptor.init(),c.listen(this._acceptor.acceptor,{accepted:function(e){t.upload(e.files[0])}}),this._state="accepting",c.dispatch(this.input,"change")}},{key:"destroy",value:function(){this._dom.field&&(this._dom.field.parentNode.removeChild(this._dom.field),this._dom.field=null),delete this._dom.input._mhFileField}},{key:"getAssetProp",value:function(t){return this.constructor.behaviours.assetProp[this._behaviours.assetProp](this,"get",t)}},{key:"init",value:function(){var t=this.constructor;this._dom.input._mhFileField=this,this.input._mhFileField=this,this._dom.field=c.create("div",{class:[t.css.field,t.css.types[this._options.fileType]].join(" ")}),this.input.parentNode.insertBefore(this._dom.field,this.input.nextSibling),this.input.value?this.populate(JSON.parse(this.input.value)):this.clear()}},{key:"populate",value:function(t){var e=this,i=this.constructor;this._destroyStateComponent(),this._asset=t,this.input.value=JSON.stringify(t);var n=this._behaviours.viewer;console.log(i.behaviours.viewer,n),this._viewer=i.behaviours.viewer[n](this),this._viewer.init(),c.listen(this._viewer.viewer,{download:function(){c.create("a",{download:"",href:e.getAssetProp("downloadURL"),target:"_blank"}).click()},edit:function(){var t=e._behaviours.imageEditor,n=i.behaviours.imageEditor[t](e);n.init(),n.show(),c.listen(n.overlay,{okay:function(){n.transforms,n.previewDataURI.then((function(t){var i=U(t,2),r=i[0];i[1],e._viewer.imageURL=r,e.setAssetProp("transforms",n.transforms),e.setAssetProp("previewURL",r),n.hide()}))},cancel:function(){n.hide()},hidden:function(){n.destroy()}})},metadata:function(){var t=e._behaviours.metadata,n=i.behaviours.metadata[t](e);n.init(),n.show(),c.listen(n.overlay,{okay:function(){var t=n.props;for(var i in t)e.setAssetProp(i,t[i]);n.hide()},cancel:function(){n.hide()},hidden:function(){n.destroy()}})},remove:function(){e.clear()}}),this._state="viewing",c.dispatch(this.input,"change")}},{key:"postError",value:function(t){var e=this;this.clearError(),this._error=new h(this.field),this._error.init(t),c.listen(this._error.error,{clear:function(){e.clearError()}}),this.field.classList.add(this.constructor.css.hasError)}},{key:"setAssetProp",value:function(t,e){this.constructor.behaviours.assetProp[this._behaviours.assetProp](this,"set",t,e),this.input.value=JSON.stringify(this._asset),c.dispatch(this.input,"change")}},{key:"upload",value:function(t){var e=this,i=this.constructor;this._destroyStateComponent();var n=i.behaviours.formData[this._behaviours.formData](this,t);this._uploader=i.behaviours.uploader[this._behaviours.uploader](this,this._options.uploadUrl,n),this._uploader.init(),c.dispatch(this.input,"uploading"),c.listen(this._uploader.uploader,{"aborted cancelled error":function(){c.dispatch(e.input,"uploadfailed"),e.clear()},uploaded:function(t){c.dispatch(e.input,"uploaded");try{var n=e._behaviours.asset,r=i.behaviours.asset[n](e,t.response);e.populate(r)}catch(t){if(!(t instanceof l.ResponseError))throw t;e.clear(),e.postError(t.message)}}}),this._state="uploading"}},{key:"_destroyStateComponent",value:function(){switch(this.clearError(),this.state){case"accepting":this._acceptor.destroy();break;case"uploading":this._uploader.destroy();break;case"viewing":this._viewer.destroy()}}},{key:"asset",get:function(){return Object.assign(this._asset,{})}},{key:"field",get:function(){return this._dom.field}},{key:"input",get:function(){return this._dom.input}},{key:"state",get:function(){return this._state}}])&&F(e.prototype,i),n&&F(e,n),t}();q.behaviours={acceptor:{default:_("field",!1)},asset:{manhattan:I()},assetProp:{manhattan:D("_asset","_options")},formData:{default:v()},imageEditor:{default:g("_options")},metadata:{manhattan:M("_options")},uploader:{default:y("field")},viewer:{default:b("field","_options")}},q.css={field:"mh-file-field",hasError:"mh-file-field--has-error",types:{file:"mh-file-field--file",image:"mh-file-field--image",svg_image:"mh-file-field--image"}};var B=i(15);function H(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function J(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var X=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._gallery=i,this._asset=null,this._state="initializing",this._error=null,this._uploader=null,this._viewer=null,this._dom={container:null,item:null},this._dom.container=e}var e,i,n;return e=t,(i=[{key:"destroy",value:function(){this.item&&(this._destroyStateComponent(),this.item.parentNode.removeChild(this._dom.item)),this.item._mhGalleryItem=null}},{key:"getAssetProp",value:function(t){return this._gallery.constructor.behaviours.assetProp[this.parentBehaviours.assetProp](this,"get",t)}},{key:"init",value:function(){var t=this.constructor;this._dom.item=c.create("div",{class:t.css.item}),this.item._mhGalleryItem=this,this._dom.container.appendChild(this._dom.item)}},{key:"populate",value:function(t){var e=this,i=this.constructor;this._destroyStateComponent(),this._asset=t;var n=this._gallery.constructor.behaviours,r=this.parentBehaviours.viewer;this._viewer=n.viewer[r](this),this._viewer.init(),c.listen(this._viewer.viewer,{download:function(){c.create("a",{download:"",href:e.getAssetProp("downloadURL"),target:"_blank"}).click()},edit:function(){var t=e.parentBehaviours.imageEditor,i=n.imageEditor[t](e);i.init(),i.show(),c.listen(i.overlay,{okay:function(){i.transforms,i.previewDataURI.then((function(t){var n=H(t,2),r=n[0];n[1],e._viewer.imageURL=r,e.setAssetProp("transforms",i.transforms),e.setAssetProp("previewURL",r),i.hide()}))},cancel:function(){i.hide()},hidden:function(){i.destroy()}})},metadata:function(){var t=e.parentBehaviours.metadata,i=n.metadata[t](e);i.init(),i.show(),c.listen(i.overlay,{okay:function(){var t=i.props;for(var n in t)e.setAssetProp(n,t[n]);i.hide()},cancel:function(){i.hide()},hidden:function(){i.destroy()}})},remove:function(){e.destroy(),c.dispatch(e.item,"removed",{item:e})}}),this._state="viewing",this.item.classList.add(i.css.populated),c.dispatch(this.item,"populated",{item:this})}},{key:"postError",value:function(t){var e=this;this._destroyStateComponent(),this._error=new h(this.item),this._error.init(t),c.listen(this._error.error,{clear:function(){e.destroy(),c.dispatch(e.item,"removed",{item:e})}}),this.item.classList.add(this.constructor.css.hasError),this._state="errored"}},{key:"setAssetProp",value:function(t,e){this._gallery.constructor.behaviours.assetProp[this.parentBehaviours.assetProp](this,"set",t,e),c.dispatch(this.item,"updated",{item:this})}},{key:"upload",value:function(t){var e=this,i=(this.constructor,this._gallery.constructor.behaviours),n=this.parentBehaviours;this._destroyStateComponent();var r=i.formData[n.formData](this,t);this._uploader=i.uploader[n.uploader](this,this.parentOptions.uploadUrl,r),this._uploader.init(),c.dispatch(this._gallery.input,"uploading"),c.listen(this._uploader.uploader,{"cancelled aborted error":function(){c.dispatch(e._gallery.input,"uploadfailed"),e.destroy(),c.dispatch(e.item,"removed",{item:e})},uploaded:function(t){c.dispatch(e._gallery.input,"uploaded");try{var r=i.asset[n.asset](e,t.response);e.populate(r)}catch(t){if(!(t instanceof l.ResponseError))throw t;e.postError(t.message)}}}),this._state="uploading"}},{key:"_destroyStateComponent",value:function(){switch(this.state){case"accepting":this._acceptor.destroy();break;case"errored":this._error.destroy();break;case"uploading":this._uploader.destroy()}}},{key:"asset",get:function(){return this._asset?Object.assign(this._asset,{}):null}},{key:"gallery",get:function(){return this._gallery}},{key:"item",get:function(){return this._dom.item}},{key:"parentBehaviours",get:function(){return this._gallery._behaviours}},{key:"parentOptions",get:function(){return this._gallery._options}},{key:"semaphore",get:function(){return this._gallery._semaphore}},{key:"state",get:function(){return this._state}}])&&J(e.prototype,i),n&&J(e,n),t}();function G(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}X.css={hasError:"mh-gallery-item--has-error",item:"mh-gallery-item",populated:"mh-gallery-item--populated"};var V=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._slots=e,this._acquiredSlots=0}var e,i,n;return e=t,(i=[{key:"acquire",value:function(){return!(this._acquiredSlots>=this._slots||(this._acquiredSlots+=1,0))}},{key:"free",value:function(){this._acquiredSlots=Math.max(0,this._acquiredSlots-1)}},{key:"reset",value:function(){this._acquiredSlots=0}}])&&G(e.prototype,i),n&&G(e,n),t}();function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}B.a.behaviours.helper.cloneGalleryItem=function(t,e){var i=e.cloneNode(!0);return i.removeAttribute("id"),i.classList.add("mh-gallery-item--sort-helper"),i};var $=function(){function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-mh-gallery--";if(Z(this,t),this._options={},c.config(this._options,{accept:"",allowDrop:!1,cropAspectRatio:"1.0",dropLabel:"Drop file here",editing:"editing",fileType:"file",fixCropAspectRatio:!1,label:"Select a file...",maxAssets:0,maxUploads:4,maxPreviewSize:[304,304],preview:"preview",sortableHelper:"cloneGalleryItem",uploadUrl:"/upload"},n,e,r),this._options.cropAspectRatio=parseFloat(this._options.cropAspectRatio),"string"==typeof this._options.maxPreviewSize){var o=this._options.maxPreviewSize.split(",");this._options.maxPreviewSize=[o[0],o[1]]}this._behaviours={},c.config(this._behaviours,{acceptor:"default",asset:"manhattan",assetProp:"manhattan",formData:"default",imageEditor:"default",metadata:"manhattan",uploader:"default",viewer:"default"},n,e,r),this._items=[],this._semaphore=new V(this._options.maxUploads),this._sortable=null,this._dom={acceptor:null,input:null,items:null,gallery:null},this._dom.input=e,this._handlers={removeItem:function(t){var e=i._items.indexOf(t.item);e>-1&&i._items.splice(e,1),i._options.maxAssets>0&&i._items.length<i._options.maxAssets&&(i._acceptor.disabled=!1),i._syncInput()},sortItems:function(t){var e=[],n=c.many(".".concat(X.css.item),i._dom.items),r=!0,o=!1,s=void 0;try{for(var a,l=n[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;e.push(u._mhGalleryItem)}}catch(t){o=!0,s=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}i._items=e,i._syncInput()},updateItem:function(t){i._syncInput()}}}var e,i,n;return e=t,(i=[{key:"destroy",value:function(){if(this._semaphore.reset(),null!==this._sortable&&(this._sortable.destroy(),this._sortable=null),this.gallery){var t=!0,e=!1,i=void 0;try{for(var n,r=this._items[Symbol.iterator]();!(t=(n=r.next()).done);t=!0)n.value.destroy()}catch(t){e=!0,i=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}this.gallery.parentNode.removeChild(this.tokenizer),this._dom.acceptor=null,this._dom.items=null,this._dom.gallery=null}this.input._mhGallery=null}},{key:"init",value:function(){var t=this,e=this.constructor;this.input._mhGallery=this,this._dom.gallery=c.create("div",{class:[e.css.gallery,e.css.types[this._options.fileType]].join(" ")}),this._dom.acceptor=c.create("div",{class:e.css.acceptor}),this._dom.gallery.appendChild(this._dom.acceptor),this._dom.items=c.create("div",{class:e.css.items}),this._dom.gallery.appendChild(this._dom.items),this.input.parentNode.insertBefore(this._dom.gallery,this.input.nextSibling);var i=this._behaviours.acceptor;if(this._acceptor=e.behaviours.acceptor[i](this),this._acceptor.init(),this._sortable=new B.a(this._dom.items,{axis:"horizontal",childSelector:".mh-gallery-item--populated",grabSelector:".mh-file-viewer__handle, .mh-image-viewer__handle",grabber:"selector",helper:this._options.sortableHelper}),this._sortable.init(),c.listen(this._acceptor.acceptor,{accepted:function(e){var i=!0,n=!1,r=void 0;try{for(var o,s=e.files[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value,l=t._addItem();if(!l)break;l.upload(a)}}catch(t){n=!0,r=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}),c.listen(this._dom.items,{sorted:this._handlers.sortItems}),this.input.value){var n=JSON.parse(this.input.value),r=!0,o=!1,s=void 0;try{for(var a,l=n[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value,h=this._addItem();if(!h)break;h.populate(u)}}catch(t){o=!0,s=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}}this._syncInput()}},{key:"_addItem",value:function(){if(this._options.maxAssets>0&&this._items.length>=this._options.maxAssets)return null;var t=new X(this._dom.items,this);return this._items.push(t),t.init(),c.listen(t.item,{removed:this._handlers.removeItem}),c.listen(t.item,{"populated updated":this._handlers.updateItem}),this._options.maxAssets>0&&this._items.length>=this._options.maxAssets&&(this._acceptor.disabled=!0),t}},{key:"_syncInput",value:function(){var t=[],e=!0,i=!1,n=void 0;try{for(var r,o=this._items.slice()[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var s=r.value;s.asset&&t.push(s.asset)}}catch(t){i=!0,n=t}finally{try{e||null==o.return||o.return()}finally{if(i)throw n}}this.input.value=JSON.stringify(t),c.dispatch(this.input,"change")}},{key:"acceptor",get:function(){return this._dom.acceptor}},{key:"gallery",get:function(){return this._dom.gallery}},{key:"input",get:function(){return this._dom.input}}])&&Y(e.prototype,i),n&&Y(e,n),t}();$.behaviours={acceptor:{default:_("acceptor",!0)},asset:{manhattan:I()},assetProp:{manhattan:D("_asset","parentOptions")},formData:{default:v()},imageEditor:{default:g("parentOptions")},metadata:{manhattan:M("parentOptions")},uploader:{default:y("item","semaphore")},viewer:{default:b("item","parentOptions")}},$.css={acceptor:"mh-gallery__acceptor",gallery:"mh-gallery",items:"mh-gallery__items",types:{file:"mh-gallery--file",image:"mh-gallery--image",svg_image:"mh-gallery--image"}};var W=i(42);i.d(e,"ui",(function(){return K})),i.d(e,"errors",(function(){return l})),i.d(e,"field",(function(){return o})),i.d(e,"gallery",(function(){return a}));var K={acceptor:p,cropTool:W,errorMessage:n,galleryItem:s,imageEditor:d,metadata:r,overlay:w,uploader:f,viewers:m}},12:function(t,e,i){"use strict";i.r(e),i.d(e,"Acceptor",(function(){return a}));var n=i(0);function r(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(e,i){var s=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Select a file...",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Drop file here",c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",h=arguments.length>6&&void 0!==arguments[6]&&arguments[6];o(this,t),this._name=i,this._label=a,this._dropLabel=l,this._allowDrop=c,this._accept=u,this._multiple=h,this._disabled=!1,this._dom={acceptor:null,container:null,dropZone:null,faceplate:null,input:null},this._dom.container=e,this._handlers={acceptDrop:function(t){if(t.preventDefault(),!s.disabled){var e=t.dataTransfer.files;e=r(e),s._multiple||(e=[e[0]]),n.dispatch(s.acceptor,"accepted",{files:e})}},change:function(t){var e=t.target.files;s.disabled||(e=r(e),s._multiple||(e=[e[0]]),s._dom.input.value="",n.dispatch(s.acceptor,"accepted",{files:e}))},dragEnd:function(t){t.preventDefault(),s.__dragEndTimout=setTimeout((function(){s.acceptor.classList.remove(s.constructor.css.fileInbound)}),150)},dragStart:function(t){t.preventDefault(),clearTimeout(s.__dragEndTimout),s.acceptor.classList.add(s.constructor.css.fileInbound)}}}var e,i,a;return e=t,(i=[{key:"destroy",value:function(){n.ignore(document,{"dragenter dragover":this._handlers.dragStart,"dragleave drop":this._handlers.dragEnd}),null!==this.acceptor&&this.acceptor.parentNode.removeChild(this.acceptor),this._dom.acceptor=null,this._dom.dropZone=null,this._dom.faceplate=null,this._dom.input=null}},{key:"init",value:function(){var t=this.constructor;this._dom.acceptor=n.create("div",{class:t.css.acceptor}),this._disabled&&this._dom.acceptor.classList.add(t.css.disabled),this._dom.input=n.create("input",{type:"file",name:this._name,class:t.css.input,title:" "}),""!==this._accept&&this._dom.input.setAttribute("accept",this._accept),this._multiple&&this._dom.input.setAttribute("multiple",""),this.acceptor.appendChild(this._dom.input),this._dom.faceplate=n.create("div",{class:t.css.faceplate}),this._dom.faceplate.innerHTML=this._label,this.acceptor.appendChild(this._dom.faceplate),this._allowDrop&&(this._dom.dropZone=n.create("div",{class:t.css.dropZone}),this._dom.dropZone.innerHTML=this._dropLabel,this.acceptor.appendChild(this._dom.dropZone)),this._dom.container.appendChild(this.acceptor),n.listen(document,{"dragenter dragover dragleave drop":this._handlers.preventDefault,"dragenter dragover":this._handlers.dragStart,"dragleave drop":this._handlers.dragEnd}),this._allowDrop&&n.listen(this._dom.dropZone,{drop:this._handlers.acceptDrop}),n.listen(this._dom.input,{change:this._handlers.change})}},{key:"acceptor",get:function(){return this._dom.acceptor}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=t,this.acceptor&&(t?this.acceptor.classList.add(this.constructor.css.disabled):this.acceptor.classList.remove(this.constructor.css.disabled))}}])&&s(e.prototype,i),a&&s(e,a),t}();a.css={acceptor:"mh-acceptor",disabled:"mh-acceptor--disabled",dropZone:"mh-acceptor__drop-zone",fileInbound:"mh-acceptor--file-inbound",faceplate:"mh-acceptor__faceplate",input:"mh-acceptor__input"}},14:function(t,e,i){"use strict";i.r(e),i.d(e,"ImageEditor",(function(){return f}));var n=i(0),r=i(42),o=i(30),s=i(1);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t,e,i){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[600,600],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return l(this,e),(i=u(this,d(e).call(this,s)))._imageURL=t,i._cropAspectRatio=n,i._fixCropAspectRatio=r,i._maxPreviewSize=o,i._imageSize=null,i._cropTool=null,i._orientation=0,i._rotating=!1,i._dom.image=null,i._dom.mask=null,i._dom.table=null,i._handlers.resize=function(t){i._fit(!0)},i._handlers.rotate=function(t){i.rotate()},i._handlers.rotated=function(t){t.target===i._dom.image&&(i._rotating=!1)},i}var i,o,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,t),i=e,(o=[{key:"destroy",value:function(){null!==this.table&&(this.content.removeChild(this._dom.table),this._dom.image=null,this._dom.mask=null,this._dom.table=null),n.ignore(window,{resize:this._handlers.resize}),h(d(e.prototype),"destroy",this).call(this)}},{key:"init",value:function(){var t=this,i=this.constructor;h(d(e.prototype),"init",this).call(this,i.css.imageEditor),this._dom.table=n.create("div",{class:i.css.table}),this.content.appendChild(this._dom.table),this._dom.image=n.create("div",{class:i.css.image}),this._dom.mask=n.create("div",{class:i.css.mask}),this._dom.image.appendChild(this._dom.mask),this._dom.image.style.transform="rotate(".concat(this._orientation,"deg)"),this._dom.table.appendChild(this._dom.image),this.addButton("rotate","rotate"),this.addButton("okay","okay"),this.addButton("cancel","cancel");var o=new Image;n.listen(o,{load:function(){t._imageSize=[o.naturalWidth,o.naturalHeight],t._cropTool=new r.CropTool(t._dom.table,t._imageURL,t._cropAspectRatio,t._fixCropAspectRatio),t._cropTool.init(),t._fit(!0),t._dom.mask.style.backgroundImage="url(".concat(t._imageURL,")"),t._cropTool.reset(),t._cropTool.visible=!0}}),o.src=this._imageURL,n.listen(this._dom.image,{transitionend:this._handlers.rotated}),n.listen(this.overlay,{rotate:this._handlers.rotate}),n.listen(window,{resize:this._handlers.resize})}},{key:"rotate",value:function(){this._rotating||(this._rotating=!0,this._cropTool.visible=!1,this._orientation-=90,this._orientation<0&&(this._dom.image.style.transition="none",this._dom.image.style.transform="rotate(360deg)",this._dom.image.getBoundingClientRect(),this._dom.image.style.transition=null,this._orientation=270),this._fit(),this._cropTool.reset(),this._cropTool.visible=!0)}},{key:"_fit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.constructor;t&&this._dom.table.classList.add(e.css.noTransitions);var i=this._dom.table.getBoundingClientRect(),n=[i.width,i.height];90!==this._orientation&&270!==this._orientation||(n=[n[1],n[0]]);var r=n[0]/this._imageSize[0],o=n[1]/this._imageSize[1],a=Math.min(r,o),l=a*this._imageSize[0],c=a*this._imageSize[1];this._dom.image.style.width="".concat(Math.ceil(l),"px"),this._dom.image.style.height="".concat(Math.ceil(c),"px"),this._dom.image.style.marginLeft="-".concat(Math.ceil(l/2),"px"),this._dom.image.style.marginTop="-".concat(Math.ceil(c/2),"px"),this._dom.image.style.left="".concat(Math.ceil(i.width/2),"px"),this._dom.image.style.top="".concat(Math.ceil(i.height/2),"px"),this._dom.image.style.transform="rotate(".concat(this._orientation,"deg)");var u=(i.width-l)/2,h=(i.height-c)/2;this._cropTool.bounds=Object(s.e)([[u,h],[u+l,h+c]],this._orientation),this._cropTool.orientation=this._orientation,t&&(this._dom.table.getBoundingClientRect(),this._dom.table.classList.remove(e.css.noTransitions))}},{key:"transforms",get:function(){var t=[];0!==this._orientation&&t.push(["rotate",this._orientation]);var e=this._cropTool.crop;return e[0][0]+e[0][1]===0&&e[1][0]+e[1][1]===2||t.push(["crop",e]),t}},{key:"previewDataURI",get:function(){var t=this;return new Promise((function(e,i){var n=document.createElement("canvas"),r=n.getContext("2d"),o=document.createElement("canvas"),s=o.getContext("2d"),a=document.createElement("canvas"),l=a.getContext("2d"),c=new Image;c.setAttribute("crossorigin","anonymous"),c.src=t._imageURL,c.onload=function(){t.constructor,n.width=c.width,n.height=c.height,90!==t._orientation&&270!==t._orientation||(n.width=c.height,n.height=c.width),r.save(),90===t._orientation||270===t._orientation?r.translate(c.height/2,c.width/2):r.translate(c.width/2,c.height/2),r.rotate(t._orientation*Math.PI/180),r.drawImage(c,-c.width/2,-c.height/2),r.restore();var i=t._cropTool.crop,u=parseInt(n.width*i[0][0],10),h=parseInt(n.height*i[0][1],10);o.width=parseInt(n.width*(i[1][0]-i[0][0]),10),o.height=parseInt(n.height*(i[1][1]-i[0][1]),10),s.drawImage(n,u,h,o.width,o.height,0,0,o.width,o.height);var d=[Math.min(t._maxPreviewSize[0],o.width),Math.min(t._maxPreviewSize[1],o.height)],p=o.width/o.height;a.width=d[0],a.height=d[0]/p,p<a.width/d[1]&&(a.width=d[1]*p,a.height=d[1]),l.drawImage(o,0,0,o.width,o.height,0,0,a.width,a.height),e([a.toDataURL(),{width:a.width,height:a.height,maxWidth:o.width}])}}))}}])&&c(i.prototype,o),a&&c(i,a),e}(o.Overlay);f.css={image:"mh-image-editor__image",imageEditor:"mh-image-editor",mask:"mh-image-editor__image-mask",noTransitions:"mh-image-editor__table--no-transitions",table:"mh-image-editor__table"}},15:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i(0);function r(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(t){var e=t;t.touches&&(e=a(t.touches,1)[0]);return[e.pageX-window.pageXOffset,e.pageY-window.pageYOffset]}var c=function(){function t(e){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-mh-sortable--";o(this,t),this._options={},n.config(this._options,{axis:"vertical",childSelector:null,grabSelector:null},r,e,s),this._behaviours={},n.config(this._behaviours,{children:"children",grabber:"self",helper:"clone",place:"auto"},r,e,s),this._grabbedOffset=null,this._dom={container:null,grabbed:null,helper:null},this._dom.container=e,this._handlers={drag:function(t){i._drag(t)},drop:function(t){i._drop(t)},grab:function(t){i._grab(t)}}}var e,i,r;return e=t,(i=[{key:"destroy",value:function(){this._dom.helper&&(document.body.removeChild(this._dom.helper),delete this._dom.helper),this.container.classList.remove(this.constructor.css.sortable),this.container.classList.remove(this.constructor.css.sorting),n.ignore(document,{mousedown:this._handlers.grab,mousemove:this._handlers.drag,mouseup:this._handlers.drop,touchstart:this._handlers.grab,touchmove:this._handlers.drag,touchend:this._handlers.drop}),delete this._dom.container._mhSortable}},{key:"init",value:function(){this._dom.container._mhSortable=this,this.container.classList.add(this.constructor.css.sortable),n.listen(document,{mousedown:this._handlers.grab,mousemove:this._handlers.drag,mouseup:this._handlers.drop,touchstart:this._handlers.grab,touchmove:this._handlers.drag,touchend:this._handlers.drop})}},{key:"_drag",value:function(t){var e=this.constructor;if(null!==this.grabbed){var i=l(t),r=[window.pageXOffset,window.pageYOffset],o=r[0]+i[0]-this._grabbedOffset[0],s=r[1]+i[1]-this._grabbedOffset[1];this._dom.helper.style.left="".concat(o,"px"),this._dom.helper.style.top="".concat(s,"px");var a=document.elementFromPoint(i[0],i[1]),c=null,u=!0,h=!1,d=void 0;try{for(var p,f=this.children[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var m=p.value;if(m!==this.grabbed&&m.contains(a)){c=m;break}}}catch(t){h=!0,d=t}finally{try{u||null==f.return||f.return()}finally{if(h)throw d}}null!==c&&(e.behaviours.place[this._behaviours.place](this,c,i)||(c=c.nextElementSibling),this.container.insertBefore(this.grabbed,c),n.dispatch(this.container,"sort",{children:this.children}))}}},{key:"_drop",value:function(t){var e=this.constructor;null!==this.grabbed&&(this.grabbed.classList.remove(e.css.ghost),this._dom.grabbed=null,this._grabbedOffset=null,this._dom.helper.parentNode.removeChild(this._dom.helper),delete this._dom.helper,this.container.classList.remove(e.css.sorting),n.dispatch(this.container,"sorted",{children:this.children}))}},{key:"_grab",value:function(t){var e=this.constructor;if("mousedown"!==t.type.toLowerCase()||1===t.which){var i=e.behaviours.grabber[this._behaviours.grabber],r=null,o=!0,s=!1,a=void 0;try{for(var c,u=this.children[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var h=c.value,d=i(this,h);if(d&&d.contains(t.target)){r=h;break}}}catch(t){s=!0,a=t}finally{try{o||null==u.return||u.return()}finally{if(s)throw a}}if(null!==r){t.preventDefault();var p=l(t),f=[window.pageXOffset,window.pageYOffset],m=r.getBoundingClientRect();this._dom.grabbed=r,this._grabbedOffset=[p[0]-m.left,p[1]-m.top],this._dom.helper=e.behaviours.helper[this._behaviours.helper](this,this.grabbed);var _=f[0]+p[0]-this._grabbedOffset[0],v=f[1]+p[1]-this._grabbedOffset[1];this._dom.helper.style.left="".concat(_,"px"),this._dom.helper.style.top="".concat(v,"px"),this._dom.helper.classList.add(e.css.helper),document.body.appendChild(this._dom.helper),this.grabbed.classList.add(e.css.ghost),this.container.classList.add(e.css.sorting),n.dispatch(this.container,"grabbed",{grabbed:this.grabbed})}}}},{key:"axis",get:function(){return this._options.axis},set:function(t){this._options.axis=t}},{key:"children",get:function(){return this.constructor.behaviours.children[this._behaviours.children](this)}},{key:"container",get:function(){return this._dom.container}},{key:"grabbed",get:function(){return this._dom.grabbed}}])&&s(e.prototype,i),r&&s(e,r),t}();c.behaviours={children:{children:function(t){var e=r(t.container.childNodes);return e.filter((function(t){return t.nodeType===Node.ELEMENT_NODE}))},selector:function(t){return n.many(t._options.childSelector,t.container)}},grabber:{selector:function(t,e){return n.one(t._options.grabSelector,e)},self:function(t,e){return e}},helper:{clone:function(t,e){var i=e.cloneNode(!0);return i.removeAttribute("id"),i.style.cssText=window.getComputedStyle(e).cssText,i.style.position="absolute",i.style["pointer-events"]="none",i}},place:{auto:function(t,e,i){t._options.axis="vertical";var n={},r=!0,o=!1,s=void 0;try{for(var a,l=t.children[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value.getBoundingClientRect().top;if(c in n){t._options.axis="horizontal";break}n[c]=!0}}catch(t){o=!0,s=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}return t.constructor.behaviours.place.axis(t,e,i)},axis:function(t,e,i){var n=e.getBoundingClientRect(),r=[i[0]-n.left,i[1]-n.top];return"vertical"===t._options.axis?r[1]<n.height/2:r[0]<n.width/2}}},c.css={ghost:"mh-sortable-ghost",helper:"mh-sortable-helper",sortable:"mh-sortable",sorting:"mh-sortable--sorting"}},16:function(t,e,i){"use strict";var n={};function r(){return document.scrollingElement?document.scrollingElement:document.body}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:60,s=n||r(),a=[s.scrollLeft,s.scrollTop],l=[t[0]-a[0],t[1]-a[1]],c=Date.now(),u=null;function h(){var t=[s.scrollLeft,s.scrollTop],n=Math.min((Date.now()-c)/1e3,e),r=n/e,o=Math.ceil(a[0]+l[0]*r),h=Math.ceil(a[1]+l[1]*r);s.scrollLeft=o,s.scrollTop=h,s.scrollLeft===o&&s.scrollTop===h||s.scrollLeft!==t[0]||s.scrollTop!==t[1]||(n=e),n===e&&("function"==typeof i&&i(),clearInterval(u))}return u=setInterval(h,1e3/o)}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:60,l=s||r(),c=t.getBoundingClientRect();return o([l.scrollLeft+c.left+e[0],l.scrollTop+c.top+e[1]],i,n,l,a)}i.r(n),i.d(n,"scrollToPosition",(function(){return o})),i.d(n,"scrollToElement",(function(){return s})),i.d(e,"a",(function(){return n}))},17:function(t,e,i){"use strict";i.r(e),i.d(e,"FileViewer",(function(){return l})),i.d(e,"ImageViewer",(function(){return c}));var n=i(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}function a(t,e,i){var r=n.create("div",{class:e});return n.listen(r,{click:function(e){e.preventDefault(),0===e.buttons&&n.dispatch(t,i)}}),r}var l=function(){function t(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{download:!0,metadata:!0,remove:!0};r(this,t),this._filename=i,this._fileSize=n,this._buttons=o,this._dom={container:null,handle:null,viewer:null},this._dom.container=e}return s(t,[{key:"destroy",value:function(){null!==this.viewer&&this.viewer.parentNode.removeChild(this.viewer),this._dom.container=null,this._dom.viewer=null}},{key:"init",value:function(){var t=this.constructor;this._dom.viewer=n.create("div",{class:t.css.viewer});var e=n.create("div",{class:t.css.info});this.viewer.appendChild(e);var i=n.create("div",{class:t.css.filename});i.textContent=this._filename,e.appendChild(i);var r=n.create("div",{class:t.css.fileSize});r.textContent=this._fileSize,e.appendChild(r);var o=n.create("div",{class:t.css.handle});this.viewer.appendChild(o);for(var s=n.create("div",{class:t.css.buttons}),l=0,c=["download","metadata","remove"];l<c.length;l++){var u=c[l];if(this._buttons[u]){var h=a(this.viewer,t.css[u],u);s.appendChild(h)}}s.children.length>0&&this.viewer.appendChild(s),this._dom.container.appendChild(this.viewer)}},{key:"viewer",get:function(){return this._dom.viewer}}]),t}();l.css={buttons:"mh-file-viewer__buttons",download:"mh-file-viewer__download",filename:"mh-file-viewer__filename",fileSize:"mh-file-viewer__file-size",handle:"mh-file-viewer__handle",info:"mh-file-viewer__info",metadata:"mh-file-viewer__metadata",remove:"mh-file-viewer__remove",viewer:"mh-file-viewer"};var c=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{download:!0,edit:!0,metadata:!0,remove:!0};r(this,t),this._imageURL=i,this._buttons=n,this._dom={container:null,image:null,viewer:null},this._dom.container=e}return s(t,[{key:"destroy",value:function(){null!==this.viewer&&this.viewer.parentNode.removeChild(this.viewer),this._dom.container=null,this._dom.viewer=null}},{key:"init",value:function(){var t=this.constructor;this._dom.viewer=n.create("div",{class:t.css.viewer}),this._dom.image=n.create("div",{class:t.css.image}),this._dom.image.style.backgroundImage="url('".concat(this._imageURL,"')"),this.viewer.appendChild(this._dom.image);var e=n.create("div",{class:t.css.handle});this.viewer.appendChild(e);for(var i=n.create("div",{class:t.css.buttons}),r=0,o=["download","edit","metadata","remove"];r<o.length;r++){var s=o[r];if(this._buttons[s]){var l=a(this.viewer,t.css[s],s);i.appendChild(l)}}i.children.length>0&&this.viewer.appendChild(i),this._dom.container.appendChild(this.viewer)}},{key:"imageURL",get:function(){return this._imageURL},set:function(t){this._imageURL=t,this._dom.image&&(this._dom.image.style.backgroundImage="url('".concat(this._imageURL,"')"))}},{key:"viewer",get:function(){return this._dom.viewer}}]),t}();c.css={buttons:"mh-image-viewer__buttons",download:"mh-image-viewer__download",edit:"mh-image-viewer__edit",handle:"mh-image-viewer__handle",image:"mh-image-viewer__image",metadata:"mh-image-viewer__metadata",remove:"mh-image-viewer__remove",viewer:"mh-image-viewer"}},171:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e){var i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-mh-character-count--";r(this,t),this._options={},n.config(this._options,{maxCharacters:0,separator:" / "},o,e,s),this._behaviours={},n.config(this._behaviours,{counter:"default"},o,e,s),this._dom={},this._dom.input=e,this._handlers={update:function(){i.update()}}}var e,i,s;return e=t,(i=[{key:"destroy",value:function(){n.ignore(this._dom.input,{input:this._handlers.update}),this._dom.counter&&this._dom.counter.remove(),delete this._dom.input._mhCharacterCount}},{key:"init",value:function(){this._dom.input._mhCharacterCount=this;var t=this.constructor.behaviours.counter[this._behaviours.counter];this._dom.counter=t(this),n.listen(this._dom.input,{input:this._handlers.update}),this.update()}},{key:"update",value:function(){var t=this.constructor,e=this._dom.input.value.length,i=this._options.maxCharacters,n=e.toString();i>0&&(n="".concat(e).concat(this._options.separator).concat(i)),this._dom.counter.innerHTML=n,i>0&&(e>i?this._dom.counter.classList.add(t.css.maxExceeded):this._dom.counter.classList.remove(t.css.maxExceeded))}},{key:"counter",get:function(){return this._dom.counter}},{key:"input",get:function(){return this._dom.input}}])&&o(e.prototype,i),s&&o(e,s),t}();s.behaviours={counter:{default:function(t){var e=t.constructor,i=n.create("div",{class:e.css.counter});return t.input.parentNode.insertBefore(i,t.input.nextSibling),i}}},s.css={counter:"mh-counter",maxExceeded:"mh-counter--max-exceeded"}},210:function(t,e,i){i(0),i(41),t.exports=i(6)},26:function(t,e,i){"use strict";i.r(e),i.d(e,"defaultStatusTemplate",(function(){return s})),i.d(e,"Uploader",(function(){return a}));var n=i(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t){return t<0?"Waiting":t>=100?"Processing":"Uploading ".concat(parseInt(t,10),"%")}var a=function(){function t(e,i,o){var a=this,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"horizontal",c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;r(this,t),this._url=i,this._formData=o,this._orientation=l,this._statusTemplate=c,this._semaphore=u,this._xhr=null,this._dom={bar:null,container:null,status:null,uploader:null},this._dom.container=e,this._handlers={cancel:function(t){var e=a.uploader;t.preventDefault(),a._xhr&&a._xhr.abort(),n.dispatch(e,"cancelled")},reqAbort:function(t){a._xhr=null,n.dispatch(a.uploader,"aborted")},reqError:function(t){a._xhr=null,n.dispatch(a.uploader,"error")},reqProgress:function(t){if(t.lengthComputable){var e=Math.max(1,t.total);a._progress(t.loaded/e*100)}else a._progress(0)},reqLoad:function(t){var e=a._xhr.response;a._xhr=null,a._progress(100),a._semaphore&&a._semaphore.free(),n.dispatch(a.uploader,"uploaded",{response:e})}}}var e,i,a;return e=t,(i=[{key:"destroy",value:function(){this._xhr&&(n.ignore(this._xhr,{abort:this._handlers.reqAbort,error:this._handlers.reqError,load:this._handlers.reqLoad}),n.ignore(this._xhr.upload,{progress:this._handlers.reqProgress}),this._xhr.abort()),null!==this.uploader&&this.uploader.parentNode.removeChild(this.uploader),this._dom.bar=null,this._dom.container=null,this._dom.status=null,this._dom.uploader=null}},{key:"init",value:function(){var t=this,e=this.constructor;this._dom.uploader=n.create("div",{class:"".concat(e.css.uploader," ").concat(e.css.pending)});var i=n.create("div",{class:e.css.meter});this.uploader.appendChild(i),this._dom.bar=n.create("div",{class:e.css.bar}),i.appendChild(this._dom.bar),this._dom.status=n.create("div",{class:e.css.status}),this.uploader.appendChild(this._dom.status);var r=n.create("div",{class:e.css.cancel});this.uploader.appendChild(r),this._dom.container.appendChild(this.uploader),n.listen(r,{click:this._handlers.cancel}),this._progress(-1),this.__uploadInterval=setInterval((function(){t._upload()}),200)}},{key:"_progress",value:function(t){var e=Math.min(Math.max(t,0),100);"horizontal"===this._orientation?this._dom.bar.style.width="".concat(e,"%"):this._dom.bar.style.height="".concat(e,"%"),this._dom.status.innerHTML=this._statusTemplate(t)}},{key:"_upload",value:function(){var t=this.constructor;this._semaphore&&!this._semaphore.acquire()||(clearInterval(this.__uploadInterval),this.uploader.classList.remove(t.css.pending),this.uploader.classList.add(t.css.uploading),this._xhr=new XMLHttpRequest,n.listen(this._xhr,{abort:this._handlers.reqAbort,error:this._handlers.reqError,load:this._handlers.reqLoad}),n.listen(this._xhr.upload,{progress:this._handlers.reqProgress}),this._xhr.open("POST",this._url,!0),this._xhr.send(this._formData))}},{key:"uploader",get:function(){return this._dom.uploader}}])&&o(e.prototype,i),a&&o(e,a),t}();a.css={bar:"mh-uploader__progress-bar",cancel:"mh-uploader__cancel",meter:"mh-uploader__progress-meter",pending:"mh-uploader--pending",status:"mh-uploader__status",uploader:"mh-uploader",uploading:"mh-uploader--uploading"}},30:function(t,e,i){"use strict";i.r(e),i.d(e,"Overlay",(function(){return s}));var n=i(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r(this,t),this._transitioning=!1,this._visible=!1,this._dom={buttons:null,close:null,container:i||document.body,content:null,overlay:null},this._handlers={cancel:function(t){"Escape"===t.key&&(t.preventDefault(),n.dispatch(e.overlay,"cancel"))},visibility:function(t){t.target===e.overlay&&("0"===getComputedStyle(e.overlay).opacity?(e._transitioning=!1,e._visible=!1,n.dispatch(e.overlay,"hidden")):(e._transitioning=!1,e._visible=!0,n.dispatch(e.overlay,"visible")))}}}var e,i,s;return e=t,(i=[{key:"addButton",value:function(e,i){var r=this,o=n.create("div",{class:t.css[e]});return n.listen(o,{click:function(t){t.preventDefault(),0===t.buttons&&n.dispatch(r.overlay,i)}}),this.buttons.appendChild(o),o}},{key:"destroy",value:function(){n.ignore(document,{keydown:this._handlers.cancel}),document.body.style.overflow=null,this.overlay&&this._dom.container.removeChild(this.overlay),this._dom.buttons=null,this._dom.close=null,this._dom.content=null,this._dom.overlay=null}},{key:"hide",value:function(){!this._transitioning&&this.visible&&(this.overlay.classList.remove(t.css.visible),this._transitioning=!0)}},{key:"init",value:function(e){this._transitioning=!1,this._visible=!1,this._dom.overlay=n.create("div",{class:[t.css.overlay,e].join(" ")}),this._dom.content=n.create("div",{class:t.css.content}),this.overlay.appendChild(this._dom.content),this._dom.buttons=n.create("div",{class:t.css.buttons}),this.overlay.appendChild(this._dom.buttons),this._dom.container.appendChild(this.overlay),document.body.style.overflow="hidden",n.listen(this.overlay,{transitionend:this._handlers.visibility}),n.listen(document,{keydown:this._handlers.cancel}),window.getComputedStyle(this.overlay).opacity}},{key:"show",value:function(){this._transitioning||this.visible||(this.overlay.classList.add(t.css.visible),this._transitioning=!0)}},{key:"buttons",get:function(){return this._dom.buttons}},{key:"content",get:function(){return this._dom.content}},{key:"overlay",get:function(){return this._dom.overlay}},{key:"visible",get:function(){return this._visible}}])&&o(e.prototype,i),s&&o(e,s),t}();s.css={buttons:"mh-overlay__buttons",cancel:"mh-overlay__cancel",content:"mh-overlay__content",close:"mh-overlay__close",okay:"mh-overlay__okay",overlay:"mh-overlay",rotate:"mh-overlay__rotate",visible:"mh-overlay--visible"}},41:function(t,e,i){"use strict";i.r(e),i.d(e,"addFilled",(function(){return s})),i.d(e,"removeFilled",(function(){return a}));var n=i(0);function r(t){var e=t.currentTarget;""===e.value?n.dispatch(e,"empty"):n.dispatch(e,"filled")}function o(t){var e=t.currentTarget;"mhFillStart"===t.animationName?n.dispatch(e,"filled"):"mhFillCancel"===t.animationName&&(""===e.value?n.dispatch(e,"empty"):n.dispatch(e,"filled"))}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"input, select, textarea",e=n.many(t);if(n.cssSelectorSupported(":-webkit-autofill")&&!n.one("[data-mh-field-filled-styles]")){var i=n.create("style",{"data-mh-field-filled-styles":!0});i.appendChild(document.createTextNode("")),document.head.appendChild(i);var s=i.sheet;s.insertRule("@keyframes mhFillStart {  from {/**/}  to {/**/}}",0),s.insertRule("@keyframes mhFillCancel {  from {/**/}  to {/**/}}",0),s.insertRule("input:-webkit-autofill { animation-name: mhFillStart; }",0),s.insertRule("input:not(:-webkit-autofill) { animation-name: mhFillCancel; }",0);var a=!0,l=!1,c=void 0;try{for(var u,h=e[Symbol.iterator]();!(a=(u=h.next()).done);a=!0){var d=u.value;n.listen(d,{animationstart:o})}}catch(t){l=!0,c=t}finally{try{a||null==h.return||h.return()}finally{if(l)throw c}}}var p=!0,f=!1,m=void 0;try{for(var _,v=e[Symbol.iterator]();!(p=(_=v.next()).done);p=!0){var g=_.value;n.listen(g,{change:r,input:r}),r({currentTarget:g})}}catch(t){f=!0,m=t}finally{try{p||null==v.return||v.return()}finally{if(f)throw m}}}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"input, select, textarea",e=!0,i=!1,s=void 0;try{for(var a,l=n.many(t)[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value;n.ignore(c,{animationstart:o,change:r,input:r})}}catch(t){i=!0,s=t}finally{try{e||null==l.return||l.return()}finally{if(i)throw s}}if(n.one("[data-mh-field-filled-styles]")){var u=n.one("[data-mh-field-filled-styles]");u.parentNode.removeChild(u)}}},42:function(t,e,i){"use strict";i.r(e);var n=i(0);function r(t){return void 0===t.pageX?[t.touches[0].pageX,t.touches[0].pageX]:[t.pageX,t.pageY]}var o=i(1);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"CropTool",(function(){return l}));var l=function(){function t(e,i){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];s(this,t),this._initialAspectRatio=a,this._fixedAspectRatio=null,l&&(this._fixedAspectRatio=a),this._bounds=[[0,0],[0,0]],this._imageURL=i,this._orientation=0,this._region=[[0,0],[0,0]],this._visible=!1,this._dom={container:null,controls:null,frame:null,image:null,region:null,tool:null},this._dom.container=e,this._drag={extents:null,origin:null,region:null},this._resize={anchor:null,extents:null,origin:null,region:null},this._handlers={drag:function(t){if(null!==n._drag.origin){t.preventDefault();var e=Math.max,i=Math.min,o=n._drag,s=o.extents,a=o.origin,l=o.region,c=r(t),u=[e(s[0][0],i(s[1][0],c[0]-a[0])),e(s[0][1],i(s[1][1],c[1]-a[1]))];n.region=[[l[0][0]+u[0],l[0][1]+u[1]],[l[1][0]+u[0],l[1][1]+u[1]]]}},endDrag:function(t){var e=n.constructor;null!==n._drag.origin&&("mouseout"!==t.type||!t.relatedTarget&&null===t.toElement)&&(t.preventDefault(),n._drag={extents:null,origin:null,region:null},n._dom.tool.classList.remove(e.css.dragging))},startDrag:function(t){var e=n.constructor;"c"===t.target.dataset.control&&("mousedown"===t.type&&0!==t.button||(t.preventDefault(),n._drag={extents:Object(o.a)(n.region,[[0,0],[Object(o.c)(n._bounds),Object(o.b)(n._bounds)]]),origin:r(t),region:n.region},n._dom.tool.classList.add(e.css.dragging)))},resize:function(t){if(null!==n._resize.origin){t.preventDefault();var e=Math.max,i=Math.min,o=n._resize,s=o.extents,a=o.matrix,l=o.origin,c=o.region,u=r(t),h=u[0]-l[0],d=u[1]-l[1],p=[e(s[0][0],i(s[1][0],h)),e(s[0][1],i(s[1][1],d))],f=a;n.region=[[c[0][0]+f[0][3]*p[0]+f[1][3]*p[1],c[0][1]+f[0][0]*p[0]+f[1][0]*p[1]],[c[1][0]+f[0][1]*p[0]+f[1][1]*p[1],c[1][1]+f[0][2]*p[0]+f[1][2]*p[1]]]}},endResize:function(t){var e=n.constructor;null!==n._resize.origin&&("mouseout"!==t.type||!t.relatedTarget&&null===t.toElement)&&(t.preventDefault(),n._resize={extents:null,matrix:null,origin:null,region:null},n._dom.tool.classList.remove(e.css.resizing))},startResize:function(t){var e=n.constructor;if(-1!==["n","ne","e","se","s","sw","w","nw"].indexOf(t.target.dataset.control)&&("mousedown"!==t.type||0===t.button)){t.preventDefault();var i=t.target.dataset.control,s=n.region,a=n._fixedAspectRatio||0,l=null,c=[[0,0],[Object(o.c)(n.bounds),Object(o.b)(n.bounds)]],u=[[0,0,0,0],[0,0,0,0]],h=0;switch(i){case"n":u[1][0]=1,l=[s[0][0]+Object(o.c)(s)/2,s[0][1]],c[1][1]=s[1][1],0!==a&&(u[1][1]=-a/2,u[1][3]=a/2,h=Math.min(l[0],c[1][0]-l[0]),c[0][0]=l[0]-h,c[1][0]=l[0]+h);break;case"ne":u[0][1]=1,u[1][0]=1,0!==a&&(u[1][0]=0,u[0][0]=-1/a),l=[s[1][0],s[0][1]],c[0][0]=s[0][0],c[1][1]=s[1][1];break;case"e":u[0][1]=1,l=[s[1][0],s[0][1]+Object(o.b)(s)/2],c[0][0]=s[0][0],0!==a&&(u[0][0]=-1/a/2,u[0][2]=1/a/2,h=Math.min(l[1],c[1][1]-l[1]),c[0][1]=l[1]-h,c[1][1]=l[1]+h);break;case"se":u[0][1]=1,u[1][2]=1,0!==a&&(u[1][2]=0,u[0][2]=1/a),l=[s[1][0],s[1][1]],c[0][0]=s[0][0],c[0][1]=s[0][1];break;case"s":u[1][2]=1,l=[s[0][0]+Object(o.c)(s)/2,s[1][1]],c[0][1]=s[0][1],0!==a&&(u[1][1]=a/2,u[1][3]=-a/2,h=Math.min(l[0],c[1][0]-l[0]),c[0][0]=l[0]-h,c[1][0]=l[0]+h);break;case"sw":u[0][3]=1,u[1][2]=1,0!==a&&(u[1][2]=0,u[0][2]=-1/a),l=[s[0][0],s[1][1]],c[1][0]=s[1][0],c[0][1]=s[0][1];break;case"w":u[0][3]=1,l=[s[0][0],s[0][1]+Object(o.b)(s)/2],c[1][0]=s[1][0],0!==a&&(u[0][0]=1/a/2,u[0][2]=-1/a/2,h=Math.min(l[1],c[1][1]-l[1]),c[0][1]=l[1]-h,c[1][1]=l[1]+h);break;case"nw":u[0][3]=1,u[1][0]=1,0!==a&&(u[1][0]=0,u[0][0]=1/a),l=[s[0][0],s[0][1]],c[1][0]=s[1][0],c[1][1]=s[1][1]}if(0!==a){var d=Object(o.c)(c),p=Object(o.c)(c)/a;a<d/Object(o.b)(c)&&(d=Object(o.b)(c)*a,p=Object(o.b)(c));var f=[s[0][0]+Object(o.c)(s)/2,s[0][1]+Object(o.b)(s)/2];switch(i){case"n":c[0][0]=f[0]-d/2,c[1][0]=f[0]+d/2,c[0][1]=c[1][1]-p;break;case"ne":c[1][0]=c[0][0]+d,c[0][1]=c[1][1]-p;break;case"e":c[0][1]=f[1]-p/2,c[1][1]=f[1]+p/2,c[1][0]=c[0][0]+d;break;case"se":c[1][0]=c[0][0]+d,c[1][1]=c[0][1]-p;break;case"s":c[0][0]=f[0]-d/2,c[1][0]=f[0]+d/2,c[1][1]=c[0][1]+p;break;case"sw":c[0][0]=c[1][0]-d,c[1][1]=c[0][1]+p;break;case"w":c[0][1]=f[1]-p/2,c[1][1]=f[1]+p/2,c[0][0]=c[1][0]-d;break;case"nw":c[0][0]=c[1][0]-d,c[0][1]=c[1][1]-p}}n._resize={extents:Object(o.a)([l,l],c),matrix:u,origin:r(t),region:s},n._dom.tool.classList.add(e.css.resizing)}}}}var e,i,l;return e=t,(i=[{key:"destroy",value:function(){null!==this._dom.tool&&(n.ignore(document,{"mousemove touchmove":this._handlers.drag,"mouseout mouseup touchend":this._handlers.endDrag}),n.ignore(document,{"mousemove touchmove":this._handlers.resize,"mouseout mouseup touchend":this._handlers.endResize}),this._dom.container.removeChild(this._dom.tool),this._dom.controls=null,this._dom.frame=null,this._dom.image=null)}},{key:"init",value:function(){var t=this.constructor;this._visible=!1,this._dom.tool=n.create("div",{class:t.css.tool}),this._dom.region=n.create("div",{class:t.css.region}),this._dom.tool.appendChild(this._dom.region),this._dom.outline=n.create("div",{class:t.css.outline}),this._dom.region.appendChild(this._dom.outline),this._dom.image=n.create("div",{class:t.css.image}),this._dom.image.style.backgroundImage="url(".concat(this._imageURL,")"),this._dom.outline.appendChild(this._dom.image);for(var e=0,i=["c","n","ne","e","se","s","sw","w","nw"];e<i.length;e++){var r=i[e],o=n.create("div",{class:"".concat(t.css.control," ").concat(t.css.controls[r]),"data-control":r});this._dom.region.appendChild(o)}this._dom.container.appendChild(this._dom.tool),n.listen(this._dom.region,{"mousedown touchstart":this._handlers.startDrag}),n.listen(this._dom.region,{"mousedown touchstart":this._handlers.startResize}),n.listen(document,{"mousemove touchmove":this._handlers.drag,"mouseout mouseup touchend":this._handlers.endDrag}),n.listen(document,{"mousemove touchmove":this._handlers.resize,"mouseout mouseup touchend":this._handlers.endResize})}},{key:"reset",value:function(){var t=this._initialAspectRatio,e=Object(o.c)(this.bounds),i=Object(o.c)(this.bounds)/t;t<e/Object(o.b)(this.bounds)&&(e=Object(o.b)(this.bounds)*t,i=Object(o.b)(this.bounds));var n=(Object(o.c)(this.bounds)-e)/2,r=(Object(o.b)(this.bounds)-i)/2;this.region=[[n,r],[n+e,r+i]],this._updateImage()}},{key:"_updateImage",value:function(){var t=[Object(o.c)(this.bounds),Object(o.b)(this.bounds)],e=[Object(o.c)(this.region),Object(o.b)(this.region)];90!==this._orientation&&270!==this._orientation||(t=[t[1],t[0]],e=[e[1],e[0]]),this._dom.image.style.backgroundSize="".concat(t[0],"px ").concat(t[1],"px"),this._dom.image.style.width="".concat(e[0],"px"),this._dom.image.style.height="".concat(e[1],"px"),this._dom.image.style.marginLeft="-".concat(e[0]/2,"px"),this._dom.image.style.marginTop="-".concat(e[1]/2,"px"),this._dom.image.style.left="".concat(Object(o.c)(this.region)/2,"px"),this._dom.image.style.top="".concat(Object(o.b)(this.region)/2,"px"),this._dom.image.style.transform="rotate(".concat(this._orientation,"deg)");var i=this._region[0][0],n=this._region[0][1];switch(this._orientation){case 90:i=this._region[0][1],n=t[1]-e[1]-this._region[0][0];break;case 180:i=t[0]-e[0]-this._region[0][0],n=t[1]-e[1]-this._region[0][1];break;case 270:i=t[0]-e[0]-this._region[0][1],n=this._region[0][0]}i=Math.ceil(i),n=Math.ceil(n),this._dom.image.style.backgroundPosition="-".concat(i,"px -").concat(n,"px")}},{key:"bounds",get:function(){return[this._bounds[0].slice(),this._bounds[1].slice()]},set:function(t){var e=Object(o.c)(t)/Object(o.c)(this._bounds);this._bounds=[t[0].slice(),t[1].slice()],this._dom.tool.style.top="".concat(this._bounds[0][1],"px"),this._dom.tool.style.left="".concat(this._bounds[0][0],"px"),this._dom.tool.style.width="".concat(Object(o.c)(this._bounds),"px"),this._dom.tool.style.height="".concat(Object(o.b)(this._bounds),"px"),this.region=Object(o.d)(this._region,e),this._updateImage()}},{key:"crop",get:function(){return[[this.region[0][0]/Object(o.c)(this.bounds),this.region[0][1]/Object(o.b)(this.bounds)],[this.region[1][0]/Object(o.c)(this.bounds),this.region[1][1]/Object(o.b)(this.bounds)]]}},{key:"orientation",get:function(){return this._orientation},set:function(t){this._orientation=t,this._updateImage()}},{key:"region",get:function(){return[this._region[0].slice(),this._region[1].slice()]},set:function(t){var e=Math.max,i=Math.min,n=this._bounds;this._region=[[e(0,i(Object(o.c)(n),t[0][0])),e(0,i(Object(o.b)(n),t[0][1]))],[e(0,i(Object(o.c)(n),t[1][0])),e(0,i(Object(o.b)(n),t[1][1]))]],this._region[1]=[e(this._region[0][0],this._region[1][0]),e(this._region[0][1],this._region[1][1])],this._dom.region.style.top="".concat(this._region[0][1],"px"),this._dom.region.style.left="".concat(this._region[0][0],"px"),this._dom.region.style.width="".concat(Object(o.c)(this._region),"px"),this._dom.region.style.height="".concat(Object(o.b)(this._region),"px"),this._updateImage()}},{key:"visible",get:function(){return this._visible},set:function(t){var e=this.constructor;this._visible=t,this._visible?this._dom.tool.classList.add(e.css.visible):this._dom.tool.classList.remove(e.css.visible)}}])&&a(e.prototype,i),l&&a(e,l),t}();l.css={control:"mh-crop-tool__control",controls:{c:"mh-crop-tool__control--c",n:"mh-crop-tool__control--n",ne:"mh-crop-tool__control--ne",e:"mh-crop-tool__control--e",se:"mh-crop-tool__control--se",s:"mh-crop-tool__control--s",sw:"mh-crop-tool__control--sw",w:"mh-crop-tool__control--w",nw:"mh-crop-tool__control--nw"},dragging:"mh-crop-tool--dragging",image:"mh-crop-tool__image",outline:"mh-crop-tool__outline",region:"mh-crop-tool__region",resizing:"mh-crop-tool--resizing",tool:"mh-crop-tool",visible:"mh-crop-tool--visible"}},6:function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"Tokenizer",(function(){return c}));var r={};i.r(r),i.d(r,"Typeahead",(function(){return p}));var o=i(0),s=i(15);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-mh-tokenizer--";a(this,t),this._options={},o.config(this._options,{allowDuplicates:!1,hiddenSelector:"",sortable:!1,typeahead:!1},n,e,r),this._behaviours={},o.config(this._behaviours,{element:"default",store:"string",tokenizer:"default"},n,e,r),this._sortable=null,this._tokens=[],this._dom={input:null,tokenizer:null},this._dom.input=e,this._handlers={add:function(t){if("keydown"!==t.type||"Enter"===t.key){t.preventDefault();var e=null,n=i.input.value.trim(),r=!1;i._options.typeahead?i.input._token?(e=i.input._token,delete i.input._token):r=!i.input._mhTypeahead.mustMatch:r=!0,r&&""!==n&&(e={label:n,value:n}),i.input.value="",null!==e&&i.addToken(e)}},remove:function(t){var e=i.constructor.css;if(t.target.classList.contains(e.remove)&&(t.preventDefault(),0===t.button)){var n=o.closest(t.target,".".concat(e.token));i.removeToken(n._token)}},sort:function(t){var e=o.many(".".concat(i.constructor.css.token),i.tokenizer);i._tokens=e.map((function(t){return t._token})),i._sync()}}}var e,i,n;return e=t,(i=[{key:"addToken",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this._options.allowDuplicates){var i=!0,n=!1,r=void 0;try{for(var s,a=this._tokens[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var l=s.value;if(t.value===l.value)return}}catch(t){n=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}}null===e?this._tokens.push(t):this._tokens.splice(e,0,t),this._sync(),o.dispatch(this.input,"tokenadded",t)}},{key:"destroy",value:function(){o.ignore(this.input,{keydown:this._handlers.add,selected:this._handlers.add}),this.tokenizer&&(o.ignore(this.tokenizer,{click:this._handlers.remove,sorted:this._handlers.sort}),this._tokens=[],this.tokenizer.parentNode.removeChild(this.tokenizer),this._dom.tokenizer=null),null!==this._sortable&&(this._sortable.destroy(),this._sortable=null),delete this._dom.input._mhTokenizer}},{key:"init",value:function(t){this.input._mhTokenizer=this;var e=this.constructor.behaviours.tokenizer[this._behaviours.tokenizer];this._dom.tokenizer=e(this),this._options.sortable&&(this._sortable=new s.a(this.tokenizer,{grabSelector:".".concat(this.constructor.css.label),grabber:"selector"}),this._sortable.init()),o.listen(this.input,{keydown:this._handlers.add,selected:this._handlers.add}),o.listen(this.tokenizer,{click:this._handlers.remove,sorted:this._handlers.sort}),this._tokens=t||[],this._sync()}},{key:"removeToken",value:function(t){this._tokens=this._tokens.filter((function(e){return e!==t})),this._sync(),o.dispatch(this.input,"tokenremoved",t)}},{key:"_sync",value:function(){var t=this.constructor.behaviours,e=o.many(".".concat(this.constructor.css.token),this.tokenizer),i=!0,n=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var l=s.value;l.parentNode.removeChild(l)}}catch(t){n=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}var c=t.element[this._behaviours.element],u=!0,h=!1,d=void 0;try{for(var p,f=this._tokens[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var m=p.value,_=c(this,m);_._token=m,this.tokenizer.appendChild(_)}}catch(t){h=!0,d=t}finally{try{u||null==f.return||f.return()}finally{if(h)throw d}}t.store[this._behaviours.store](this)}},{key:"input",get:function(){return this._dom.input}},{key:"tokenizer",get:function(){return this._dom.tokenizer}},{key:"tokens",get:function(){return this._tokens.slice()}}])&&l(e.prototype,i),n&&l(e,n),t}();function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}c.behaviours={element:{default:function(t,e){var i=o.create("div",{class:t.constructor.css.label});i.textContent=e.label;var n=o.create("div",{class:t.constructor.css.remove}),r=o.create("div",{class:t.constructor.css.token});return r.appendChild(i),r.appendChild(n),r}},store:{inputs:function(t){var e=t.input.form,i=t._options.hiddenSelector,n=o.many('[name="'.concat(i,'"]'),e),r=!0,s=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){var u=l.value;u.parentNode.removeChild(u)}}catch(t){s=!0,a=t}finally{try{r||null==c.return||c.return()}finally{if(s)throw a}}var h=!0,d=!1,p=void 0;try{for(var f,m=t.tokens[Symbol.iterator]();!(h=(f=m.next()).done);h=!0){var _=f.value,v=o.create("input",{name:i,value:_.value});e.appendChild(v)}}catch(t){d=!0,p=t}finally{try{h||null==m.return||m.return()}finally{if(d)throw p}}},json:function(t){var e=t.tokens.map((function(t){return t.value}));o.one(t._options.hiddenSelector).value=JSON.stringify(e)},none:function(t){return null},string:function(t){var e=t.tokens.map((function(t){return t.value}));o.one(t._options.hiddenSelector).value=e.join(",")}},tokenizer:{default:function(t){var e=t.constructor,i=o.create("div",{class:e.css.tokenizer});return t.input.parentNode.insertBefore(i,t.input.nextSibling),i}}},c.css={label:"mh-token__label",remove:"mh-token__remove",token:"mh-token",tokenizer:"mh-tokenizer"};var p=function(){function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-mh-typeahead--";h(this,t),this._options={},o.config(this._options,{autocompleteAttr:"off",autoFirst:!1,disableCache:!1,hiddenSelector:"",list:[],maxSuggestions:10,minChars:2,mustMatch:!1},n,e,r),this._behaviours={},o.config(this._behaviours,{coerce:"passThrough",element:"default",fetch:"array",filter:"startswith",input:"setValue",query:"value",sort:"length"},n,e,r),this._cache=null,this._index=-1,this._open=!1,this._suggestions=null,this._dom={input:null,typeahead:null},this._dom.input=e,this._handlers={close:function(t){i.close()},nav:function(t){if(i.isOpen)switch(t.key){case"Tab":i._options.mustMatch&&i.select();break;case"Enter":i.index>-1?(t.preventDefault(),i.select()):i.close();break;case"Escape":i.close();break;case"ArrowUp":case"Up":t.preventDefault(),i.previous();break;case"ArrowDown":case"Down":t.preventDefault(),i.next()}},select:function(t){if(t.target!==i.typeahead&&0===t.button){t.preventDefault();for(var e=t.target;e.parentNode!==i.typeahead;)e=e.parentNode;var n=Array.prototype.indexOf.call(i.typeahead.children,e);i.select(n)}},update:function(t){var e=i.constructor.behaviours.query[i._behaviours.query](i);i._delayedUpdate&&clearTimeout(i._delayedUpdate),i._delayedUpdate=setTimeout((function(){i.update(e)}),100)}}}var e,i,n;return e=t,(i=[{key:"clear",value:function(){this.constructor.behaviours.input[this._behaviours.input](this,null)}},{key:"clearCache",value:function(){this._cache={}}},{key:"close",value:function(){this.isOpen&&(this.typeahead.classList.remove(this.constructor.css.open),this._open=!1,this._index=-1,o.dispatch(this.input,"closed"))}},{key:"destroy",value:function(){o.ignore(window,{fullscreenchange:this._handlers.close,orientationchange:this._handlers.close,resize:this._handlers.close}),o.ignore(this.input,{blur:this._handlers.close,input:this._handlers.update,keydown:this._handlers.nav}),this._delayedUpdate&&clearTimeout(this._delayedUpdate),this._signal&&(this._signal.cancelled=!0),this.typeahead&&(o.listen(this.typeahead,{mousedown:this._handlers.select}),document.body.removeChild(this.typeahead),this._dom.typeahead=null),this.clearCache(),this._suggestions=null,delete this._dom.input._mhTypeahead}},{key:"focus",value:function(t){var e=this.constructor.css.focused,i=o.one(".".concat(e),this.typeahead);i&&i.classList.remove(e),this._index=t,this.focused&&this.typeahead.children[this.index].classList.add(e)}},{key:"init",value:function(){this.input._mhTypeahead=this,this._suggestions=[],this.clearCache(),this.input.setAttribute("autocomplete",this._options.autocompleteAttr),this._dom.typeahead=o.create("div",{class:this.constructor.css.typeahead}),document.body.appendChild(this._dom.typeahead),o.listen(window,{fullscreenchange:this._handlers.close,orientationchange:this._handlers.close,resize:this._handlers.close}),o.listen(this.typeahead,{mousedown:this._handlers.select}),o.listen(this.input,{blur:this._handlers.close,input:this._handlers.update,keydown:this._handlers.nav})}},{key:"next",value:function(){0!==this.suggestionCount&&(this.index>=this.suggestionCount-1?this.focus(0):this.focus(this.index+1))}},{key:"open",value:function(){this._options.autoFirst&&-1===this.index&&this.focus(0),this.isOpen||0!==this.suggestionCount&&(this._track(),this.typeahead.classList.add(this.constructor.css.open),this._open=!0,o.dispatch(this.input,"opened"))}},{key:"previous",value:function(){0!==this.suggestionCount&&(this.index<=0?this.focus(this.suggestionCount-1):this.focus(this.index-1))}},{key:"select",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==t&&t!==this.index&&this.focus(t),-1!==this.index){var e=this._suggestions[this.index];o.dispatch(this.input,"select",{suggestion:e})&&(this.constructor.behaviours.input[this._behaviours.input](this,e),this.close(),o.dispatch(this.input,"selected",{suggestion:e}))}}},{key:"update",value:function(t){var e=this,i=this.constructor.behaviours;for(this._index=-1,this._suggestions=[];this.typeahead.firstChild;)this.typeahead.removeChild(this.typeahead.firstChild);return 0===t.length&&this.clear(),t.length<this._options.minChars?(this.close(),null):(this._signal&&(this._signal.cancelled=!0),this._signal={cancelled:!1},i.fetch[this._behaviours.fetch](this,t,this._signal).then((function(n){var r=u(n,2),o=r[0];if(!r[1].cancelled)if(0!==o.length){var s=i.coerce[e._behaviours.coerce],a=o.map((function(t){return s(e,t)})),l=i.filter[e._behaviours.filter];a=a.filter((function(i){return l(e,i,t)}));var c=i.sort[e._behaviours.sort];if(a=(a=a.sort((function(i,n){return c(e,t,i,n)}))).slice(0,e._options.maxSuggestions),e._suggestions=a,0!==e._suggestions.length){var h=i.element[e._behaviours.element],d=!0,p=!1,f=void 0;try{for(var m,_=e._suggestions[Symbol.iterator]();!(d=(m=_.next()).done);d=!0){var v=m.value,g=h(e,v,t);e.typeahead.appendChild(g)}}catch(t){p=!0,f=t}finally{try{d||null==_.return||_.return()}finally{if(p)throw f}}e.open()}else e.close()}else e.close()})).catch((function(t){e.close()})))}},{key:"_track",value:function(){var t=this.input.getBoundingClientRect(),e=t.top+window.pageYOffset,i=t.left+window.pageXOffset;this.typeahead.style.top="".concat(e+t.height,"px"),this.typeahead.style.left="".concat(i,"px"),this.typeahead.style.width="".concat(t.width,"px")}},{key:"focused",get:function(){return-1===this.index?null:this._suggestions[this.index]}},{key:"index",get:function(){return this._index}},{key:"input",get:function(){return this._dom.input}},{key:"isOpen",get:function(){return this._open}},{key:"mustMatch",get:function(){return this._options.mustMatch}},{key:"suggestionCount",get:function(){return this._suggestions.length}},{key:"suggestions",get:function(){return this._suggestions.slice()}},{key:"typeahead",get:function(){return this._dom.typeahead}}])&&d(e.prototype,i),n&&d(e,n),t}();p.behaviours={coerce:{passThrough:function(t,e){return e},valueOnly:function(t,e){return{label:e,value:e}}},element:{default:function(t,e,i){var n=o.create("div",{class:t.constructor.css.suggestion});return n.innerHTML=e.label.replace(new RegExp(o.escapeRegExp(i),"gi"),"<mark>$&</mark>"),n}},fetch:{ajax:function(t,e,i){var n=e.substr(0,t._options.minChars).toLowerCase(),r=e;if(!t._options.disableCache&&(r=n,t._cache[n]))return new Promise((function(e,r){e([t._cache[n],i])}));var o=t._options.list;return o=1===o.split("?",2).length?"".concat(o,"?q=").concat(encodeURIComponent(r)):"".concat(o,"&q=").concat(encodeURIComponent(r)),fetch(o,{credentials:"include"}).then((function(t){return t.json()})).then((function(e){return t._options.disableCache||(t._cache[n]=e.payload.suggestions),[e.payload.suggestions,i]}))},array:function(t,e,i){return new Promise((function(e,n){e([t._options.list,i])}))},elements:function(t,e,i){return new Promise((function(e,n){e([o.many(t._options.list).map((function(t){var e=t.textContent.trim();return{label:e,value:e}})),i])}))},json:function(t,e,i){return new Promise((function(e,n){e([JSON.parse(t._options.list),i])}))},string:function(t,e,i){return new Promise((function(e,n){e([t._options.list.split(","),i])}))}},filter:{contains:function(t,e,i){return e.label.toLowerCase().indexOf(i.toLowerCase())>-1},startswith:function(t,e,i){return e.label.toLowerCase().substr(0,i.length)===i.toLowerCase()}},input:{setHidden:function(t,e){var i=o.one(t._options.hiddenSelector);null===e?(t.input.value="",i.value=""):(t.input.value=e.label,i.value=e.value),o.dispatch(t.input,"change")},setValue:function(t,e){t.input.value=null===e?"":e.value,o.dispatch(t.input,"change")},tokenizer:function(t,e){t.input._token=e,o.dispatch(t.input,"change")}},query:{value:function(t){return t.input.value.trim()}},sort:{length:function(t,e,i,n){var r=e.toLowerCase(),o=r===i.label.substr(0,r.length).toLowerCase(),s=r===n.label.substr(0,r.length).toLowerCase();return o&&!s?-1:s&&!o||i.label.length>n.label.length?1:i.label.length<n.label.length?-1:i.label>n.label?1:-1}}},p.css={focused:"mh-typeahead__suggestion--focused",open:"mh-typeahead--open",suggestion:"mh-typeahead__suggestion",typeahead:"mh-typeahead"},i.d(e,"tokenizer",(function(){return n})),i.d(e,"typeahead",(function(){return r}))},9:function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){var e="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return a(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,t)})(t)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t,e,i){return(a=s()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&l(r,i.prototype),r}).apply(null,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}i.r(e),i.d(e,"ResponseError",(function(){return u}));var u=function(t){function e(t){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=r(this,c(e).call(this,t))).message=t,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,t),e}(o(Error))}}]);